<template>
  <div class="sp-assets">
    <div class="sp-assets__header sp-component-title">
      <h3>我的NFT</h3>
    </div>
    <div class="sp-assets__main sp-box sp-shadow">
      <div class="sp-assets__main__header" v-if="address()">
        <div class="sp-assets__main__header__token">NFT</div>
        <div class="sp-assets__main__header__amount">数量</div>
      </div>
      <div class="sp-assets__main__header" v-else>
        <div class="sp-assets__main__header__message">Your current account balance will appear here</div>
      </div>

      <div class="sp-assets__main__item" v-for="balance in fullBalances" v-bind:key="'denom_' + balance.denom">
        <div class="sp-assets__main__denom__name">
          <div class="sp-denom-marker" :style="'background: #' + balance.color" />
            {{ balance }}
        </div>
        <div class="sp-assets__main__denom__balance">
          1
        </div>
      </div>
    </div>
  </div>
</template>
<script lang="ts">
import { defineComponent, PropType } from 'vue'
import { str2rgba } from '../../utils/helpers'



import { BaseTest, NFTObj } from '../../utils/interfaces'



export default defineComponent({
  name: 'SpNFTAssets',
  data() {
    return {
      nfts: {} as String[],
    }
  },
  computed: {
    fullBalances: function (): String[] {
      return this.nfts;
    },
  },
  methods: {
    address: function (): string {
      return this.$store.getters['common/wallet/address']
    },
    gotNFTBalances: async function (): Promise<void> {
      await BaseTest.getClient()
        .nft.queryOwner(this.address(),'gws')
        .then(res => {
          console.log(JSON.stringify(res));
          let x:NFTObj = JSON.parse(JSON.stringify(res));
          if (x.owner){
            this.nfts=x.owner?.idCollectionsList[0]?.tokenIdsList;
          }
        })
        .catch(error => {
          console.log(error);
        })
      }
  },
  created: function (): void {
    this.gotNFTBalances();
  },
  beforeUpdate: function (): void {
    this.gotNFTBalances();
  },
})
</script>
