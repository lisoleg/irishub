{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.error.cause.js\");\n\nrequire(\"core-js/modules/es.typed-array.at.js\");\n\nrequire(\"core-js/modules/es.typed-array.set.js\");\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.presentPacketData = exports.splitPendingPackets = exports.timeGreater = exports.heightGreater = exports.parseAck = exports.parseAcksFromLogs = exports.parsePacket = exports.parseHeightAttribute = exports.parsePacketsFromLogs = exports.parsePacketsFromBlockResult = exports.buildClientState = exports.buildConsensusState = exports.secondsFromDateNanos = exports.timestampFromDateNanos = exports.mapRpcPubKeyToProto = exports.may = exports.parseRevisionNumber = exports.subtractBlock = exports.ensureIntHeight = exports.toIntHeight = exports.createBroadcastTxErrorMessage = void 0;\n\nconst encoding_1 = require(\"@cosmjs/encoding\");\n\nconst stargate_1 = require(\"@cosmjs/stargate\");\n\nconst {\n  parseEvent\n} = stargate_1.logs;\n\nconst long_1 = __importDefault(require(\"long\"));\n\nconst proofs_1 = require(\"../codec/confio/proofs\");\n\nconst timestamp_1 = require(\"../codec/google/protobuf/timestamp\");\n\nconst channel_1 = require(\"../codec/ibc/core/channel/v1/channel\");\n\nconst tendermint_1 = require(\"../codec/ibc/lightclients/tendermint/v1/tendermint\");\n\nfunction createBroadcastTxErrorMessage(result) {\n  return `Error when broadcasting tx ${result.transactionHash} at height ${result.height}. Code: ${result.code}; Raw log: ${result.rawLog}`;\n}\n\nexports.createBroadcastTxErrorMessage = createBroadcastTxErrorMessage;\n\nfunction toIntHeight(height) {\n  var _a, _b;\n\n  return (_b = (_a = height === null || height === void 0 ? void 0 : height.revisionHeight) === null || _a === void 0 ? void 0 : _a.toNumber()) !== null && _b !== void 0 ? _b : 0;\n}\n\nexports.toIntHeight = toIntHeight;\n\nfunction ensureIntHeight(height) {\n  if (typeof height === 'number') {\n    return height;\n  }\n\n  return toIntHeight(height);\n}\n\nexports.ensureIntHeight = ensureIntHeight;\n\nfunction subtractBlock(height, count = 1) {\n  return {\n    revisionNumber: height.revisionNumber,\n    revisionHeight: height.revisionHeight.subtract(count)\n  };\n}\n\nexports.subtractBlock = subtractBlock;\nconst regexRevNum = new RegExp('-([1-9][0-9]*)$');\n\nfunction parseRevisionNumber(chainId) {\n  const match = chainId.match(regexRevNum);\n\n  if (match && match.length >= 2) {\n    return long_1.default.fromString(match[1]);\n  }\n\n  return new long_1.default(0);\n}\n\nexports.parseRevisionNumber = parseRevisionNumber; // may will run the transform if value is defined, otherwise returns undefined\n\nfunction may(transform, value) {\n  return value === undefined || value === null ? undefined : transform(value);\n}\n\nexports.may = may;\n\nfunction mapRpcPubKeyToProto(pubkey) {\n  if (pubkey === undefined) {\n    return undefined;\n  }\n\n  if (pubkey.algorithm == 'ed25519') {\n    return {\n      ed25519: pubkey.data,\n      secp256k1: undefined\n    };\n  } else if (pubkey.algorithm == 'secp256k1') {\n    return {\n      ed25519: undefined,\n      secp256k1: pubkey.data\n    };\n  } else {\n    throw new Error( // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    `Unknown validator pubkey type: ${pubkey.algorithm}`);\n  }\n}\n\nexports.mapRpcPubKeyToProto = mapRpcPubKeyToProto;\n\nfunction timestampFromDateNanos(date) {\n  var _a;\n\n  const nanos = date.getTime() % 1000 * 1000000 + ((_a = date.nanoseconds) !== null && _a !== void 0 ? _a : 0);\n  return timestamp_1.Timestamp.fromPartial({\n    seconds: new long_1.default(date.getTime() / 1000),\n    nanos\n  });\n}\n\nexports.timestampFromDateNanos = timestampFromDateNanos;\n\nfunction secondsFromDateNanos(date) {\n  return Math.floor(date.getTime() / 1000);\n}\n\nexports.secondsFromDateNanos = secondsFromDateNanos;\n\nfunction buildConsensusState(header) {\n  return tendermint_1.ConsensusState.fromPartial({\n    timestamp: timestampFromDateNanos(header.time),\n    root: {\n      hash: header.appHash\n    },\n    nextValidatorsHash: header.nextValidatorsHash\n  });\n}\n\nexports.buildConsensusState = buildConsensusState; // Note: we hardcode a number of assumptions, like trust level, clock drift, and assume revisionNumber is 1\n\nfunction buildClientState(chainId, unbondingPeriodSec, trustPeriodSec, height) {\n  // Copied here until https://github.com/confio/ics23/issues/36 is resolved\n  // https://github.com/confio/ics23/blob/master/js/src/proofs.ts#L11-L26\n  const iavlSpec = {\n    leafSpec: {\n      prefix: Uint8Array.from([0]),\n      hash: proofs_1.HashOp.SHA256,\n      prehashValue: proofs_1.HashOp.SHA256,\n      prehashKey: proofs_1.HashOp.NO_HASH,\n      length: proofs_1.LengthOp.VAR_PROTO\n    },\n    innerSpec: {\n      childOrder: [0, 1],\n      minPrefixLength: 4,\n      maxPrefixLength: 12,\n      childSize: 33,\n      hash: proofs_1.HashOp.SHA256\n    }\n  };\n  const tendermintSpec = {\n    leafSpec: {\n      prefix: Uint8Array.from([0]),\n      hash: proofs_1.HashOp.SHA256,\n      prehashValue: proofs_1.HashOp.SHA256,\n      prehashKey: proofs_1.HashOp.NO_HASH,\n      length: proofs_1.LengthOp.VAR_PROTO\n    },\n    innerSpec: {\n      childOrder: [0, 1],\n      minPrefixLength: 1,\n      maxPrefixLength: 1,\n      childSize: 32,\n      hash: proofs_1.HashOp.SHA256\n    }\n  };\n  return tendermint_1.ClientState.fromPartial({\n    chainId,\n    trustLevel: {\n      numerator: long_1.default.fromInt(1),\n      denominator: long_1.default.fromInt(3)\n    },\n    unbondingPeriod: {\n      seconds: new long_1.default(unbondingPeriodSec)\n    },\n    trustingPeriod: {\n      seconds: new long_1.default(trustPeriodSec)\n    },\n    maxClockDrift: {\n      seconds: new long_1.default(20)\n    },\n    latestHeight: height,\n    proofSpecs: [iavlSpec, tendermintSpec],\n    upgradePath: ['upgrade', 'upgradedIBCState'],\n    allowUpdateAfterExpiry: false,\n    allowUpdateAfterMisbehaviour: false\n  });\n}\n\nexports.buildClientState = buildClientState;\n\nfunction decodeBase64(value) {\n  return Buffer.from(value).toString('binary');\n}\n\nfunction parsePacketsFromBlockResult(result) {\n  const allEvents = result.beginBlockEvents.concat(...result.endBlockEvents).filter(({\n    type\n  }) => type === 'send_packet').map(({\n    type,\n    attributes\n  }) => ({\n    type,\n    attributes: attributes.map(({\n      key,\n      value\n    }) => ({\n      key: decodeBase64(key),\n      value: decodeBase64(value)\n    }))\n  }));\n  const flatEvents = [].concat(allEvents.map(parseEvent));\n  return flatEvents.map(parsePacket);\n}\n\nexports.parsePacketsFromBlockResult = parsePacketsFromBlockResult;\n\nfunction parsePacketsFromLogs(logs) {\n  // grab all send_packet events from the logs\n  const allEvents = logs.map(log => log.events.filter(({\n    type\n  }) => type === 'send_packet'));\n  const flatEvents = [].concat(...allEvents);\n  return flatEvents.map(parsePacket);\n}\n\nexports.parsePacketsFromLogs = parsePacketsFromLogs;\n\nfunction parseHeightAttribute(attribute) {\n  var _a;\n\n  const [timeoutRevisionNumber, timeoutRevisionHeight] = (_a = attribute === null || attribute === void 0 ? void 0 : attribute.split('-')) !== null && _a !== void 0 ? _a : [];\n\n  if (!timeoutRevisionHeight || !timeoutRevisionNumber) {\n    return undefined;\n  }\n\n  const revisionNumber = long_1.default.fromString(timeoutRevisionNumber);\n  const revisionHeight = long_1.default.fromString(timeoutRevisionHeight); // note: 0 revisionNumber is allowed. If there is bad data, '' or '0-0', we will get 0 for the height\n\n  if (revisionHeight.isZero()) {\n    return undefined;\n  }\n\n  return {\n    revisionHeight,\n    revisionNumber\n  };\n}\n\nexports.parseHeightAttribute = parseHeightAttribute;\n\nfunction parsePacket({\n  type,\n  attributes\n}) {\n  if (type !== 'send_packet') {\n    throw new Error(`Cannot parse event of type ${type}`);\n  }\n\n  const attributesObj = attributes.reduce((acc, {\n    key,\n    value\n  }) => Object.assign(Object.assign({}, acc), {\n    [key]: value\n  }), {});\n  return channel_1.Packet.fromPartial({\n    sequence: may(long_1.default.fromString, attributesObj.packet_sequence),\n\n    /** identifies the port on the sending chain. */\n    sourcePort: attributesObj.packet_src_port,\n\n    /** identifies the channel end on the sending chain. */\n    sourceChannel: attributesObj.packet_src_channel,\n\n    /** identifies the port on the receiving chain. */\n    destinationPort: attributesObj.packet_dst_port,\n\n    /** identifies the channel end on the receiving chain. */\n    destinationChannel: attributesObj.packet_dst_channel,\n\n    /** actual opaque bytes transferred directly to the application module */\n    data: attributesObj.packet_data ? encoding_1.toUtf8(attributesObj.packet_data) : undefined,\n\n    /** block height after which the packet times out */\n    timeoutHeight: parseHeightAttribute(attributesObj.packet_timeout_height),\n\n    /** block timestamp (in nanoseconds) after which the packet times out */\n    timeoutTimestamp: may(long_1.default.fromString, attributesObj.packet_timeout_timestamp)\n  });\n}\n\nexports.parsePacket = parsePacket;\n\nfunction parseAcksFromLogs(logs) {\n  // grab all send_packet events from the logs\n  const allEvents = logs.map(log => log.events.filter(({\n    type\n  }) => type === 'write_acknowledgement'));\n  const flatEvents = [].concat(...allEvents);\n  return flatEvents.map(parseAck);\n}\n\nexports.parseAcksFromLogs = parseAcksFromLogs;\n\nfunction parseAck({\n  type,\n  attributes\n}) {\n  var _a, _b;\n\n  if (type !== 'write_acknowledgement') {\n    throw new Error(`Cannot parse event of type ${type}`);\n  }\n\n  const attributesObj = attributes.reduce((acc, {\n    key,\n    value\n  }) => Object.assign(Object.assign({}, acc), {\n    [key]: value\n  }), {});\n  const originalPacket = channel_1.Packet.fromPartial({\n    sequence: may(long_1.default.fromString, attributesObj.packet_sequence),\n\n    /** identifies the port on the sending chain. */\n    sourcePort: attributesObj.packet_src_port,\n\n    /** identifies the channel end on the sending chain. */\n    sourceChannel: attributesObj.packet_src_channel,\n\n    /** identifies the port on the receiving chain. */\n    destinationPort: attributesObj.packet_dst_port,\n\n    /** identifies the channel end on the receiving chain. */\n    destinationChannel: attributesObj.packet_dst_channel,\n\n    /** actual opaque bytes transferred directly to the application module */\n    data: encoding_1.toUtf8((_a = attributesObj.packet_data) !== null && _a !== void 0 ? _a : ''),\n\n    /** block height after which the packet times out */\n    timeoutHeight: parseHeightAttribute(attributesObj.packet_timeout_height),\n\n    /** block timestamp (in nanoseconds) after which the packet times out */\n    timeoutTimestamp: may(long_1.default.fromString, attributesObj.packet_timeout_timestamp)\n  });\n  const acknowledgement = encoding_1.toUtf8((_b = attributesObj.packet_ack) !== null && _b !== void 0 ? _b : '');\n  return {\n    acknowledgement,\n    originalPacket\n  };\n}\n\nexports.parseAck = parseAck; // return true if a > b, or a undefined\n\nfunction heightGreater(a, b) {\n  if (a === undefined) {\n    return true;\n  } // comparing longs made some weird issues (maybe signed/unsigned)?\n  // convert to numbers to compare safely\n\n\n  const [numA, heightA, numB, heightB] = [a.revisionNumber.toNumber(), a.revisionHeight.toNumber(), b.revisionNumber.toNumber(), b.revisionHeight.toNumber()];\n  const valid = numA > numB || numA == numB && heightA > heightB;\n  return valid;\n}\n\nexports.heightGreater = heightGreater; // return true if a > b, or a 0\n// note a is nanoseconds, while b is seconds\n\nfunction timeGreater(a, b) {\n  if (a === undefined || a.isZero()) {\n    return true;\n  }\n\n  const valid = a.toNumber() > b * 1000000000;\n  return valid;\n}\n\nexports.timeGreater = timeGreater; // take height and time from receiving chain to see which packets have timed out\n// return [toSubmit, toTimeout].\n// you can advance height, time a block or two into the future if you wish a margin of error\n\nfunction splitPendingPackets(currentHeight, currentTime, // in seconds\npackets) {\n  return packets.reduce((acc, packet) => {\n    const validPacket = heightGreater(packet.packet.timeoutHeight, currentHeight) && timeGreater(packet.packet.timeoutTimestamp, currentTime);\n    return validPacket ? Object.assign(Object.assign({}, acc), {\n      toSubmit: [...acc.toSubmit, packet]\n    }) : Object.assign(Object.assign({}, acc), {\n      toTimeout: [...acc.toTimeout, packet]\n    });\n  }, {\n    toSubmit: [],\n    toTimeout: []\n  });\n}\n\nexports.splitPendingPackets = splitPendingPackets;\n\nfunction presentPacketData(data) {\n  try {\n    return JSON.parse(encoding_1.fromUtf8(data));\n  } catch (_a) {\n    return {\n      hex: encoding_1.toHex(data)\n    };\n  }\n}\n\nexports.presentPacketData = presentPacketData;","map":{"version":3,"sources":["../../src/lib/utils.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.presentPacketData = exports.splitPendingPackets = exports.timeGreater = exports.heightGreater = exports.parseAck = exports.parseAcksFromLogs = exports.parsePacket = exports.parseHeightAttribute = exports.parsePacketsFromLogs = exports.parsePacketsFromBlockResult = exports.buildClientState = exports.buildConsensusState = exports.secondsFromDateNanos = exports.timestampFromDateNanos = exports.mapRpcPubKeyToProto = exports.may = exports.parseRevisionNumber = exports.subtractBlock = exports.ensureIntHeight = exports.toIntHeight = exports.createBroadcastTxErrorMessage = void 0;\nconst encoding_1 = require(\"@cosmjs/encoding\");\nconst stargate_1 = require(\"@cosmjs/stargate\");\nconst { parseEvent } = stargate_1.logs;\nconst long_1 = __importDefault(require(\"long\"));\nconst proofs_1 = require(\"../codec/confio/proofs\");\nconst timestamp_1 = require(\"../codec/google/protobuf/timestamp\");\nconst channel_1 = require(\"../codec/ibc/core/channel/v1/channel\");\nconst tendermint_1 = require(\"../codec/ibc/lightclients/tendermint/v1/tendermint\");\nfunction createBroadcastTxErrorMessage(result) {\n    return `Error when broadcasting tx ${result.transactionHash} at height ${result.height}. Code: ${result.code}; Raw log: ${result.rawLog}`;\n}\nexports.createBroadcastTxErrorMessage = createBroadcastTxErrorMessage;\nfunction toIntHeight(height) {\n    var _a, _b;\n    return (_b = (_a = height === null || height === void 0 ? void 0 : height.revisionHeight) === null || _a === void 0 ? void 0 : _a.toNumber()) !== null && _b !== void 0 ? _b : 0;\n}\nexports.toIntHeight = toIntHeight;\nfunction ensureIntHeight(height) {\n    if (typeof height === 'number') {\n        return height;\n    }\n    return toIntHeight(height);\n}\nexports.ensureIntHeight = ensureIntHeight;\nfunction subtractBlock(height, count = 1) {\n    return {\n        revisionNumber: height.revisionNumber,\n        revisionHeight: height.revisionHeight.subtract(count),\n    };\n}\nexports.subtractBlock = subtractBlock;\nconst regexRevNum = new RegExp('-([1-9][0-9]*)$');\nfunction parseRevisionNumber(chainId) {\n    const match = chainId.match(regexRevNum);\n    if (match && match.length >= 2) {\n        return long_1.default.fromString(match[1]);\n    }\n    return new long_1.default(0);\n}\nexports.parseRevisionNumber = parseRevisionNumber;\n// may will run the transform if value is defined, otherwise returns undefined\nfunction may(transform, value) {\n    return value === undefined || value === null ? undefined : transform(value);\n}\nexports.may = may;\nfunction mapRpcPubKeyToProto(pubkey) {\n    if (pubkey === undefined) {\n        return undefined;\n    }\n    if (pubkey.algorithm == 'ed25519') {\n        return {\n            ed25519: pubkey.data,\n            secp256k1: undefined,\n        };\n    }\n    else if (pubkey.algorithm == 'secp256k1') {\n        return {\n            ed25519: undefined,\n            secp256k1: pubkey.data,\n        };\n    }\n    else {\n        throw new Error(\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        `Unknown validator pubkey type: ${pubkey.algorithm}`);\n    }\n}\nexports.mapRpcPubKeyToProto = mapRpcPubKeyToProto;\nfunction timestampFromDateNanos(date) {\n    var _a;\n    const nanos = (date.getTime() % 1000) * 1000000 + ((_a = date.nanoseconds) !== null && _a !== void 0 ? _a : 0);\n    return timestamp_1.Timestamp.fromPartial({\n        seconds: new long_1.default(date.getTime() / 1000),\n        nanos,\n    });\n}\nexports.timestampFromDateNanos = timestampFromDateNanos;\nfunction secondsFromDateNanos(date) {\n    return Math.floor(date.getTime() / 1000);\n}\nexports.secondsFromDateNanos = secondsFromDateNanos;\nfunction buildConsensusState(header) {\n    return tendermint_1.ConsensusState.fromPartial({\n        timestamp: timestampFromDateNanos(header.time),\n        root: {\n            hash: header.appHash,\n        },\n        nextValidatorsHash: header.nextValidatorsHash,\n    });\n}\nexports.buildConsensusState = buildConsensusState;\n// Note: we hardcode a number of assumptions, like trust level, clock drift, and assume revisionNumber is 1\nfunction buildClientState(chainId, unbondingPeriodSec, trustPeriodSec, height) {\n    // Copied here until https://github.com/confio/ics23/issues/36 is resolved\n    // https://github.com/confio/ics23/blob/master/js/src/proofs.ts#L11-L26\n    const iavlSpec = {\n        leafSpec: {\n            prefix: Uint8Array.from([0]),\n            hash: proofs_1.HashOp.SHA256,\n            prehashValue: proofs_1.HashOp.SHA256,\n            prehashKey: proofs_1.HashOp.NO_HASH,\n            length: proofs_1.LengthOp.VAR_PROTO,\n        },\n        innerSpec: {\n            childOrder: [0, 1],\n            minPrefixLength: 4,\n            maxPrefixLength: 12,\n            childSize: 33,\n            hash: proofs_1.HashOp.SHA256,\n        },\n    };\n    const tendermintSpec = {\n        leafSpec: {\n            prefix: Uint8Array.from([0]),\n            hash: proofs_1.HashOp.SHA256,\n            prehashValue: proofs_1.HashOp.SHA256,\n            prehashKey: proofs_1.HashOp.NO_HASH,\n            length: proofs_1.LengthOp.VAR_PROTO,\n        },\n        innerSpec: {\n            childOrder: [0, 1],\n            minPrefixLength: 1,\n            maxPrefixLength: 1,\n            childSize: 32,\n            hash: proofs_1.HashOp.SHA256,\n        },\n    };\n    return tendermint_1.ClientState.fromPartial({\n        chainId,\n        trustLevel: {\n            numerator: long_1.default.fromInt(1),\n            denominator: long_1.default.fromInt(3),\n        },\n        unbondingPeriod: {\n            seconds: new long_1.default(unbondingPeriodSec),\n        },\n        trustingPeriod: {\n            seconds: new long_1.default(trustPeriodSec),\n        },\n        maxClockDrift: {\n            seconds: new long_1.default(20),\n        },\n        latestHeight: height,\n        proofSpecs: [iavlSpec, tendermintSpec],\n        upgradePath: ['upgrade', 'upgradedIBCState'],\n        allowUpdateAfterExpiry: false,\n        allowUpdateAfterMisbehaviour: false,\n    });\n}\nexports.buildClientState = buildClientState;\nfunction decodeBase64(value) {\n    return Buffer.from(value).toString('binary');\n}\nfunction parsePacketsFromBlockResult(result) {\n    const allEvents = result.beginBlockEvents\n        .concat(...result.endBlockEvents)\n        .filter(({ type }) => type === 'send_packet')\n        .map(({ type, attributes }) => ({\n        type,\n        attributes: attributes.map(({ key, value }) => ({\n            key: decodeBase64(key),\n            value: decodeBase64(value),\n        })),\n    }));\n    const flatEvents = [].concat(allEvents.map(parseEvent));\n    return flatEvents.map(parsePacket);\n}\nexports.parsePacketsFromBlockResult = parsePacketsFromBlockResult;\nfunction parsePacketsFromLogs(logs) {\n    // grab all send_packet events from the logs\n    const allEvents = logs.map((log) => log.events.filter(({ type }) => type === 'send_packet'));\n    const flatEvents = [].concat(...allEvents);\n    return flatEvents.map(parsePacket);\n}\nexports.parsePacketsFromLogs = parsePacketsFromLogs;\nfunction parseHeightAttribute(attribute) {\n    var _a;\n    const [timeoutRevisionNumber, timeoutRevisionHeight] = (_a = attribute === null || attribute === void 0 ? void 0 : attribute.split('-')) !== null && _a !== void 0 ? _a : [];\n    if (!timeoutRevisionHeight || !timeoutRevisionNumber) {\n        return undefined;\n    }\n    const revisionNumber = long_1.default.fromString(timeoutRevisionNumber);\n    const revisionHeight = long_1.default.fromString(timeoutRevisionHeight);\n    // note: 0 revisionNumber is allowed. If there is bad data, '' or '0-0', we will get 0 for the height\n    if (revisionHeight.isZero()) {\n        return undefined;\n    }\n    return { revisionHeight, revisionNumber };\n}\nexports.parseHeightAttribute = parseHeightAttribute;\nfunction parsePacket({ type, attributes }) {\n    if (type !== 'send_packet') {\n        throw new Error(`Cannot parse event of type ${type}`);\n    }\n    const attributesObj = attributes.reduce((acc, { key, value }) => (Object.assign(Object.assign({}, acc), { [key]: value })), {});\n    return channel_1.Packet.fromPartial({\n        sequence: may(long_1.default.fromString, attributesObj.packet_sequence),\n        /** identifies the port on the sending chain. */\n        sourcePort: attributesObj.packet_src_port,\n        /** identifies the channel end on the sending chain. */\n        sourceChannel: attributesObj.packet_src_channel,\n        /** identifies the port on the receiving chain. */\n        destinationPort: attributesObj.packet_dst_port,\n        /** identifies the channel end on the receiving chain. */\n        destinationChannel: attributesObj.packet_dst_channel,\n        /** actual opaque bytes transferred directly to the application module */\n        data: attributesObj.packet_data\n            ? encoding_1.toUtf8(attributesObj.packet_data)\n            : undefined,\n        /** block height after which the packet times out */\n        timeoutHeight: parseHeightAttribute(attributesObj.packet_timeout_height),\n        /** block timestamp (in nanoseconds) after which the packet times out */\n        timeoutTimestamp: may(long_1.default.fromString, attributesObj.packet_timeout_timestamp),\n    });\n}\nexports.parsePacket = parsePacket;\nfunction parseAcksFromLogs(logs) {\n    // grab all send_packet events from the logs\n    const allEvents = logs.map((log) => log.events.filter(({ type }) => type === 'write_acknowledgement'));\n    const flatEvents = [].concat(...allEvents);\n    return flatEvents.map(parseAck);\n}\nexports.parseAcksFromLogs = parseAcksFromLogs;\nfunction parseAck({ type, attributes }) {\n    var _a, _b;\n    if (type !== 'write_acknowledgement') {\n        throw new Error(`Cannot parse event of type ${type}`);\n    }\n    const attributesObj = attributes.reduce((acc, { key, value }) => (Object.assign(Object.assign({}, acc), { [key]: value })), {});\n    const originalPacket = channel_1.Packet.fromPartial({\n        sequence: may(long_1.default.fromString, attributesObj.packet_sequence),\n        /** identifies the port on the sending chain. */\n        sourcePort: attributesObj.packet_src_port,\n        /** identifies the channel end on the sending chain. */\n        sourceChannel: attributesObj.packet_src_channel,\n        /** identifies the port on the receiving chain. */\n        destinationPort: attributesObj.packet_dst_port,\n        /** identifies the channel end on the receiving chain. */\n        destinationChannel: attributesObj.packet_dst_channel,\n        /** actual opaque bytes transferred directly to the application module */\n        data: encoding_1.toUtf8((_a = attributesObj.packet_data) !== null && _a !== void 0 ? _a : ''),\n        /** block height after which the packet times out */\n        timeoutHeight: parseHeightAttribute(attributesObj.packet_timeout_height),\n        /** block timestamp (in nanoseconds) after which the packet times out */\n        timeoutTimestamp: may(long_1.default.fromString, attributesObj.packet_timeout_timestamp),\n    });\n    const acknowledgement = encoding_1.toUtf8((_b = attributesObj.packet_ack) !== null && _b !== void 0 ? _b : '');\n    return {\n        acknowledgement,\n        originalPacket,\n    };\n}\nexports.parseAck = parseAck;\n// return true if a > b, or a undefined\nfunction heightGreater(a, b) {\n    if (a === undefined) {\n        return true;\n    }\n    // comparing longs made some weird issues (maybe signed/unsigned)?\n    // convert to numbers to compare safely\n    const [numA, heightA, numB, heightB] = [\n        a.revisionNumber.toNumber(),\n        a.revisionHeight.toNumber(),\n        b.revisionNumber.toNumber(),\n        b.revisionHeight.toNumber(),\n    ];\n    const valid = numA > numB || (numA == numB && heightA > heightB);\n    return valid;\n}\nexports.heightGreater = heightGreater;\n// return true if a > b, or a 0\n// note a is nanoseconds, while b is seconds\nfunction timeGreater(a, b) {\n    if (a === undefined || a.isZero()) {\n        return true;\n    }\n    const valid = a.toNumber() > b * 1000000000;\n    return valid;\n}\nexports.timeGreater = timeGreater;\n// take height and time from receiving chain to see which packets have timed out\n// return [toSubmit, toTimeout].\n// you can advance height, time a block or two into the future if you wish a margin of error\nfunction splitPendingPackets(currentHeight, currentTime, // in seconds\npackets) {\n    return packets.reduce((acc, packet) => {\n        const validPacket = heightGreater(packet.packet.timeoutHeight, currentHeight) &&\n            timeGreater(packet.packet.timeoutTimestamp, currentTime);\n        return validPacket\n            ? Object.assign(Object.assign({}, acc), { toSubmit: [...acc.toSubmit, packet] }) : Object.assign(Object.assign({}, acc), { toTimeout: [...acc.toTimeout, packet] });\n    }, {\n        toSubmit: [],\n        toTimeout: [],\n    });\n}\nexports.splitPendingPackets = splitPendingPackets;\nfunction presentPacketData(data) {\n    try {\n        return JSON.parse(encoding_1.fromUtf8(data));\n    }\n    catch (_a) {\n        return { hex: encoding_1.toHex(data) };\n    }\n}\nexports.presentPacketData = presentPacketData;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvbGliL3V0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLCtDQUEyRDtBQUMzRCwrQ0FBNEQ7QUFDNUQsTUFBTSxFQUFFLFVBQVUsRUFBRSxHQUFHLGVBQUksQ0FBQztBQU81QixnREFBd0I7QUFFeEIsbURBQTBEO0FBQzFELGtFQUErRDtBQUMvRCxrRUFBOEQ7QUFFOUQsbUZBRzREO0FBVTVELFNBQWdCLDZCQUE2QixDQUMzQyxNQUEwQjtJQUUxQixPQUFPLDhCQUE4QixNQUFNLENBQUMsZUFBZSxjQUFjLE1BQU0sQ0FBQyxNQUFNLFdBQVcsTUFBTSxDQUFDLElBQUksY0FBYyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUM7QUFDNUksQ0FBQztBQUpELHNFQUlDO0FBRUQsU0FBZ0IsV0FBVyxDQUFDLE1BQWU7O0lBQ3pDLE9BQU8sTUFBQSxNQUFBLE1BQU0sYUFBTixNQUFNLHVCQUFOLE1BQU0sQ0FBRSxjQUFjLDBDQUFFLFFBQVEsRUFBRSxtQ0FBSSxDQUFDLENBQUM7QUFDakQsQ0FBQztBQUZELGtDQUVDO0FBRUQsU0FBZ0IsZUFBZSxDQUFDLE1BQXVCO0lBQ3JELElBQUksT0FBTyxNQUFNLEtBQUssUUFBUSxFQUFFO1FBQzlCLE9BQU8sTUFBTSxDQUFDO0tBQ2Y7SUFDRCxPQUFPLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUM3QixDQUFDO0FBTEQsMENBS0M7QUFFRCxTQUFnQixhQUFhLENBQUMsTUFBYyxFQUFFLEtBQUssR0FBRyxDQUFDO0lBQ3JELE9BQU87UUFDTCxjQUFjLEVBQUUsTUFBTSxDQUFDLGNBQWM7UUFDckMsY0FBYyxFQUFFLE1BQU0sQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQztLQUN0RCxDQUFDO0FBQ0osQ0FBQztBQUxELHNDQUtDO0FBRUQsTUFBTSxXQUFXLEdBQUcsSUFBSSxNQUFNLENBQUMsaUJBQWlC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"]},"metadata":{},"sourceType":"script"}